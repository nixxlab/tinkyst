"use strict";(self["webpackChunktinkyst"]=self["webpackChunktinkyst"]||[]).push([[519],{5519:(e,a,l)=>{l.r(a),l.d(a,{default:()=>x});var t=l(3673),n=l(2323);const s={class:"text-h4"},r=(0,t.Wm)("td",null,null,-1),u=(0,t.Wm)("td",{style:{"font-weight":"bold"}},"Всего",-1),o={ref:"chart_canvas",style:{width:"300px"}},c=(0,t.Wm)("div",{class:"text-h6"}," Оценочная стоимость портфеля ",-1),i=(0,t.Wm)("td",null,"В пересчёте на Рубль РФ",-1),d={align:"right",style:{"font-weight":"bold"}},b=(0,t.Wm)("td",null,"В пересчёте на Доллар США",-1),f={align:"right",style:{"font-weight":"bold"}},v=(0,t.Wm)("td",null,"В пересчёте на Евро",-1),h={align:"right",style:{"font-weight":"bold"}};function m(e,a,l,m,g,w){const p=(0,t.up)("q-markup-table"),_=(0,t.up)("q-page");return(0,t.wg)(),(0,t.j4)(_,{class:"column fit q-gutter-md q-pa-md",style:{"max-width":"1000px"}},{default:(0,t.w5)((()=>[(0,t.Wm)("div",s,(0,n.zw)(e.$t("portfolio_capital")),1),(0,t.Wm)(p,{flat:""},{default:(0,t.w5)((()=>[(0,t.Wm)("tbody",null,[(0,t.Wm)("tr",null,[r,((0,t.wg)(!0),(0,t.j4)(t.HY,null,(0,t.Ko)(e.balances,((e,a)=>((0,t.wg)(),(0,t.j4)("td",{align:"right",key:a}," Активы в "+(0,n.zw)(a),1)))),128))]),(0,t.Wm)("tr",null,[(0,t.Wm)("td",null,(0,n.zw)(e.$t("cash")),1),((0,t.wg)(!0),(0,t.j4)(t.HY,null,(0,t.Ko)(e.balances,((a,l)=>((0,t.wg)(),(0,t.j4)("td",{align:"right",key:l},(0,n.zw)(e.number_format.format(a.cash))+" "+(0,n.zw)(e.currencies.find((e=>e.value===l)).label),1)))),128))]),(0,t.Wm)("tr",null,[(0,t.Wm)("td",null,(0,n.zw)(e.$t("shares")),1),((0,t.wg)(!0),(0,t.j4)(t.HY,null,(0,t.Ko)(e.balances,((a,l)=>((0,t.wg)(),(0,t.j4)("td",{align:"right",key:l},(0,n.zw)(e.number_format.format(a.shares))+" "+(0,n.zw)(e.currencies.find((e=>e.value===l)).label),1)))),128))]),(0,t.Wm)("tr",null,[(0,t.Wm)("td",null,(0,n.zw)(e.$t("bonds")),1),((0,t.wg)(!0),(0,t.j4)(t.HY,null,(0,t.Ko)(e.balances,((a,l)=>((0,t.wg)(),(0,t.j4)("td",{align:"right",key:l},(0,n.zw)(e.number_format.format(a.bonds))+" "+(0,n.zw)(e.currencies.find((e=>e.value===l)).label),1)))),128))]),(0,t.Wm)("tr",null,[(0,t.Wm)("td",null,(0,n.zw)(e.$t("funds")),1),((0,t.wg)(!0),(0,t.j4)(t.HY,null,(0,t.Ko)(e.balances,((a,l)=>((0,t.wg)(),(0,t.j4)("td",{align:"right",key:l},(0,n.zw)(e.number_format.format(a.funds))+" "+(0,n.zw)(e.currencies.find((e=>e.value===l)).label),1)))),128))]),(0,t.Wm)("tr",null,[u,((0,t.wg)(!0),(0,t.j4)(t.HY,null,(0,t.Ko)(e.balances,((a,l)=>((0,t.wg)(),(0,t.j4)("td",{align:"right",style:{"font-weight":"bold"},key:l},(0,n.zw)(e.number_format.format(a.total))+" "+(0,n.zw)(e.currencies.find((e=>e.value===l)).label),1)))),128))])])])),_:1}),(0,t.Wm)("canvas",o,null,512),(0,t.Wm)("div",null,[c,(0,t.Wm)(p,{flat:""},{default:(0,t.w5)((()=>[(0,t.Wm)("tbody",null,[(0,t.Wm)("tr",null,[i,(0,t.Wm)("td",d,(0,n.zw)(e.number_format.format(e.balance_in_rub.total))+" ₽",1)]),(0,t.Wm)("tr",null,[b,(0,t.Wm)("td",f,(0,n.zw)(e.number_format.format(e.balance_in_usd.total))+" $",1)]),(0,t.Wm)("tr",null,[v,(0,t.Wm)("td",h,(0,n.zw)(e.number_format.format(e.balance_in_eur.total))+" €",1)])])])),_:1})])])),_:1})}var g=l(2888),w=l(1959),p=l(5948),_=l(9582),y=l(7874);const W=[{label:"€",value:"EUR",name:"Евро"},{label:"₽",value:"RUB",name:"Рубль"},{label:"$",value:"USD",name:"Доллар США"}],k=(0,t.aZ)({setup(){const e=(0,p.QT)({useScope:"global"}),a=(0,_.tv)(),l=(0,y.oR)(),n=l.getters["tinkoff/accounts"],s=l.getters["tinkoff/eur_price"],r=l.getters["tinkoff/usd_price"],u=(0,w.iH)({bonds:0,cash:0,funds:0,shares:0,total:0}),o=(0,w.iH)({bonds:0,cash:0,funds:0,shares:0,total:0}),c=(0,w.iH)({bonds:0,cash:0,funds:0,shares:0,total:0}),i=(0,w.iH)({}),d=Intl.NumberFormat("ru-RU"),b=(0,w.iH)(null);let f={},v=null;if(n)for(var h in n.forEach((e=>{e.currencies.forEach((e=>{i.value[e.currency]||0==e.balance||(i.value[e.currency]={bonds:0,cash:0,funds:0,shares:0,total:0}),0!=e.balance&&(i.value[e.currency].cash+=e.balance)})),e.positions.forEach((e=>{switch(i.value[e.averagePositionPrice.currency]||(i.value[e.averagePositionPrice.currency]={bonds:0,cash:0,funds:0,shares:0,total:0}),e.instrumentType){case"Bond":i.value[e.averagePositionPrice.currency].bonds+=e.averagePositionPrice.value*e.balance+e.expectedYield.value;break;case"Currency":break;case"Etf":i.value[e.averagePositionPrice.currency].funds+=e.averagePositionPrice.value*e.balance+e.expectedYield.value;break;case"Stock":i.value[e.averagePositionPrice.currency].shares+=e.averagePositionPrice.value*e.balance+e.expectedYield.value;break}i.value[e.averagePositionPrice.currency].total+=e.averagePositionPrice.value*e.balance+e.expectedYield.value}))})),i.value){let e=i.value[h],a="EUR"==h?1:"USD"==h?r/s:1/s,l="EUR"==h?s:"USD"==h?r:1,t="EUR"==h?s/r:"USD"==h?1:1/r;u.value.bonds+=a*e.bonds,u.value.cash+=a*e.cash,u.value.funds+=a*e.funds,u.value.shares+=a*e.shares,u.value.total+=a*(e.cash+e.shares+e.bonds+e.funds),o.value.bonds+=l*e.bonds,o.value.cash+=l*e.cash,o.value.funds+=l*e.funds,o.value.shares+=l*e.shares,o.value.total+=l*(e.cash+e.shares+e.bonds+e.funds),c.value.bonds+=t*e.bonds,c.value.cash+=t*e.cash,c.value.funds+=t*e.funds,c.value.shares+=t*e.shares,c.value.total+=t*(e.cash+e.shares+e.bonds+e.funds)}else a.push("/settings");function m(){g.Z.defaults.color="rgba(0, 0, 0, 1)",g.Z.defaults.font.size=12,v&&v.destroy(),v=new g.Z(b.value,{type:"pie",data:f,options:{plugins:{legend:{position:"top"},tooltip:{callbacks:{footer:a=>[e.t("weight")+": "+Math.round(100*a[0].parsed/c.value.total)+"%",e.t("usd_value_equivalent")+": $"+d.format(parseInt(a[0].parsed))].join("\n"),label:e=>"",title:e=>e[0].label}}},responsive:!1,title:{display:!0,text:"Распределение активов в портфеле"}}})}return(0,t.bv)((()=>{f={labels:[e.t("bonds"),e.t("cash"),e.t("funds"),e.t("shares")],datasets:[{data:[c.value.bonds,c.value.cash,c.value.funds,c.value.shares],backgroundColor:["#537bc4","#acc236","#f53794","#8549ba"]}]},m()})),{balance_in_eur:u,balance_in_rub:o,balance_in_usd:c,balances:i,chart_canvas:b,currencies:W,eur_price:s,number_format:d,usd_price:r}}});var P=l(4379),z=l(481),j=l(7518),H=l.n(j);k.render=m;const x=k;H()(k,"components",{QPage:P.Z,QMarkupTable:z.Z})}}]);